{"version":3,"sources":["Leaflet.TOC.NestedDynamicMapLayer.js"],"names":["NestedDynamicMapLayer","_isAttached","layers","layer","getLayers","Array","isArray","includes","layerID","push","setLayers","map","hasLayer","addLayer","filter","id","length","removeLayer"],"mappings":";;;;;;;;AAAA;;;;;;;;;;;;IAEqBA,qB;;;;;;;;;;;8BACT;AACR;AACA,UAAI,CAAC,KAAKC,WAAV,EAAuB;AACrB;AACA;;AAEA,YAAIC,SAAS,KAAKC,KAAL,CAAWC,SAAX,EAAb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAI,CAACC,MAAMC,OAAN,CAAcJ,MAAd,CAAL,EAA4B;AAC1B;AACAA,mBAAS,EAAT;AACD;AACD;AACA;AACA;AACA,YAAI,CAACA,OAAOK,QAAP,CAAgB,KAAKC,OAArB,CAAL,EAAoC;AAClC;AACA;AACAN,iBAAOO,IAAP,CAAY,KAAKD,OAAjB;AACA,eAAKL,KAAL,CAAWO,SAAX,CAAqBR,MAArB;AACD;;AAGD;AACA,YAAI,CAAC,KAAKS,GAAL,CAASC,QAAT,CAAkB,KAAKT,KAAvB,CAAL,EAAoC;AAClC,eAAKQ,GAAL,CAASE,QAAT,CAAkB,KAAKV,KAAvB;AACD;AACF;;AAED,WAAKF,WAAL,GAAmB,IAAnB;AACD;;;8BAES;AAAA;;AACR,UAAI,KAAKA,WAAT,EAAsB;AACpB;AACA;AACA,YAAIC,SAAS,KAAKC,KAAL,CAAWC,SAAX,GAAuBU,MAAvB,CAA8B,UAACC,EAAD,EAAQ;AACjD,iBAAOA,OAAO,OAAKP,OAAnB;AACD,SAFY,CAAb;AAGA,aAAKL,KAAL,CAAWO,SAAX,CAAqBR,MAArB;;AAEA;AACA,YAAIA,OAAOc,MAAP,KAAkB,CAAlB,IAAuB,KAAKL,GAAL,CAASC,QAAT,CAAkB,KAAKT,KAAvB,CAA3B,EAA0D;AACxD,eAAKQ,GAAL,CAASM,WAAT,CAAqB,KAAKd,KAA1B;AACD;AACF;;AAED,WAAKF,WAAL,GAAmB,KAAnB;AACD;;;;;;kBAtDkBD,qB","file":"Leaflet.TOC.NestedDynamicMapLayer.js","sourcesContent":["import NestedLayer from './Leaflet.TOC.NestedLayer';\n\nexport default class NestedDynamicMapLayer extends NestedLayer {\n  _attach() {\n    // console.log(this.layer.getLayers);\n    if (!this._isAttached) {\n      // push the layerID into the list of layers to render\n      // http://esri.github.io/esri-leaflet/api-reference/layers/dynamic-map-layer.html#methods\n\n      let layers = this.layer.getLayers();\n      // if the DynamicMapLayer was instantiated without providing a list of layer IDs as an option,\n      // then .getLayers will return 'false' (as of esri-leaflet@2.0.8)\n      // in JavaScript, 'typeof []'' will return 'object', so use Array.isArray to verify that .getLayers\n      // returned an actual array\n      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/typeof\n      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray\n      if (!Array.isArray(layers)) {\n        // .getLayers returned false (see above), so set the empty array ourselves\n        layers = [];\n      }\n      // setLayers allows you to introduce duplicate IDs\n      // this check prevents that from happening\n      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes\n      if (!layers.includes(this.layerID)) {\n        // Array.push returns the new length of the array, not the array itself\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/push\n        layers.push(this.layerID);\n        this.layer.setLayers(layers);\n      }\n\n\n      // ensure the Leaflet layer is actually on the map object\n      if (!this.map.hasLayer(this.layer)) {\n        this.map.addLayer(this.layer);\n      }\n    }\n\n    this._isAttached = true;\n  }\n\n  _detach() {\n    if (this._isAttached) {\n      // remove the layerID from the list of layers to render\n      // http://esri.github.io/esri-leaflet/api-reference/layers/dynamic-map-layer.html#methods\n      let layers = this.layer.getLayers().filter((id) => {\n        return id !== this.layerID;\n      });\n      this.layer.setLayers(layers);\n\n      // if there are no more layers left, remove the layer from the map object\n      if (layers.length === 0 && this.map.hasLayer(this.layer)) {\n        this.map.removeLayer(this.layer);\n      }\n    }\n\n    this._isAttached = false;\n  }\n}\n"],"sourceRoot":"/mnt/c/dev/Leaflet.Control.NestedLayers/src"}