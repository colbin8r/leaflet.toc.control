<html>

<head>
<title>Leaflet.Control.NestedLayers plugin demo &mdash; Simple</title>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ==" crossorigin=""/>
<!-- <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js" integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg==" crossorigin=""></script> -->

<!-- Plugin -->
<script src="./bundle.js"></script>

<!-- Esri Leaflet -->
<script src="https://unpkg.com/esri-leaflet@2.0.8"></script>

<style>
body {
  padding: 0;
  margin: 0;
}
#map, #toc {
  height: 50vh;
  width: 100%;
}
.layer-name {
  cursor: pointer;
}

.leaf.enabled {
  color: limegreen;
}
.leaf.disabled {
  color: grey;
}


</style>

</head>
<body>

<div id="map">

</div>

<div id="toc">

</div>

<script>

// var map = L.map('map').setView([51.505, -0.09], 13);
var map = L.map('map').setView([37.4316, -78.6569], 13);

// sample layer
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
    maxZoom: 18,
    id: 'mapbox.streets',
    accessToken: 'pk.eyJ1IjoiY29sYmluOHIiLCJhIjoiY2o0OHA1a3EyMGhqaTJ3cDJpZ3V3bWtwYyJ9.EVWPRmgB_cDROLCbCAEr7Q'
}).addTo(map);

// manually assemble a small layer hierarchy
var mapserverURL = 'http://gis.vdot.virginia.gov/arcgis/rest/services/varoads/ADT/MapServer';

var leafletLayers = {
  parent: L.esri.dynamicMapLayer({
    url: mapserverURL,
    opacity : 0.25,
    layers: [0]
  }),
  child1: L.esri.dynamicMapLayer({
    url: mapserverURL,
    opacity : 0.25,
    layers: [1]
  }),
  child2: L.esri.dynamicMapLayer({
    url: mapserverURL,
    opacity : 0.25,
    layers: [2]
  }),
  baby1: L.esri.dynamicMapLayer({
    url: mapserverURL,
    opacity : 0.25,
    layers: [3]
  })
}

var layers = [
  L.nestedLayer({
    id: leafletLayers.parent.getLayers()[0],
    name: "Interstates (1)",
    layer: leafletLayers.parent,
    map: map,
    swatch: "iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAAA1BMVEUA/wA0XsCoAAAADUlEQVR4AWMY9GAUAAABpAABXUC05gAAAABJRU5ErkJggg==",
    children: [
      L.nestedLayer({
        id: leafletLayers.child1.getLayers()[0],
        name: "US Highways (1.A)",
        layer: leafletLayers.child1,
        map: map,
        swatch: "iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAAA1BMVEUAAP+KeNJXAAAADUlEQVR4AWMY9GAUAAABpAABXUC05gAAAABJRU5ErkJggg==",
        children: []
      }),
      L.nestedLayer({
        id: leafletLayers.child2.getLayers()[0],
        name: "State Routes (1.B)",
        layer: leafletLayers.child2,
        map: map,
        swatch: "iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAAA1BMVEX/AP804Oa6AAAADUlEQVR4AWMY9GAUAAABpAABXUC05gAAAABJRU5ErkJggg==",
        children: [
          L.nestedLayer({
            id: leafletLayers.baby1.getLayers()[0],
            name: "All Roads (1.B.1)",
            layer: leafletLayers.baby1,
            map: map,
            swatch: "iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAAA1BMVEX/AP804Oa6AAAADUlEQVR4AWMY9GAUAAABpAABXUC05gAAAABJRU5ErkJggg==",
            children: []
          })
        ]
      })
    ]
  })
]

var hierarchy = L.layerHierarchy({ layers: layers });

// put together the Table of Contents (TOC) control
var tocEl = document.getElementById('toc');
var toc = L.control.nestedLayers(hierarchy, tocEl);

</script>
</body>

</html>
